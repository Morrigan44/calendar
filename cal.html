 <!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>10-Day SL Calendar</title>
  <style>
    body {
      margin: 0;
      padding: 16px;
      font-family: sans-serif;
      background: #202020;
      color: #fff;
    }
    .days-container {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      grid-gap: 16px;
    }
    .day-block {
      background: #2a2a2a;
      padding: 12px;
      border-radius: 8px;
      height: 200px;             /* fixed height */
      overflow: hidden;          /* no scrollbars */
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
    }
    .day-block h4 {
      margin: 0 0 8px;
      font-size: 1.1em;
      border-bottom: 1px solid #444;
      padding-bottom: 4px;
      flex: 0 0 auto;
    }
    ul {
      list-style: none;
      padding: 0;
      margin: 0;
      flex: 1 1 auto;            /* take remaining space */
    }
    li {
      margin-bottom: 6px;
      line-height: 1.3;
    }
    .time {
      font-weight: bold;
      margin-right: 6px;
    }
    .location a {
      color: #8af;
      text-decoration: underline;
      font-size: 0.9em;
      display: block;
      margin-top: 2px;
    }
    #err {
      color: #f88;
      margin-top: 12px;
    }
  </style>
</head>
<body>

  <h3>Upcoming 10 Days</h3>
  <div id="calendar" class="days-container"></div>
  <div id="err"></div>

  <script>
    const CAL_ID_RAW = 'wgnews10@gmail.com';
    const CAL_ID     = encodeURIComponent(CAL_ID_RAW);
    const API_KEY    = 'AIzaSyAAhKKZtAqK4LNj0V6od_HbwWGltuei_oY';
    const DAYS       = 10;
    const MAX_EVENTS = 250;  // total across all days
    const MAX_PER_DAY = 3;   // cap events per day

    // build date window: today 00:00 â†’ 10 days out 23:59
    const start = new Date();
    start.setHours(0,0,0,0);
    const end = new Date(start);
    end.setDate(end.getDate() + DAYS - 1);
    end.setHours(23,59,59,999);

    const params = new URLSearchParams({
      key:          API_KEY,
      timeMin:      start.toISOString(),
      timeMax:      end.toISOString(),
      maxResults:   MAX_EVENTS,
      singleEvents: true,
      orderBy:      'startTime'
    });

    fetch(`https://www.googleapis.com/calendar/v3/calendars/${CAL_ID}/events?` + params)
      .then(res => res.json().then(json => {
        if (!res.ok) throw new Error((json.error && json.error.message) || `HTTP ${res.status}`);
        return json;
      }))
      .then(data => {
        const container = document.getElementById('calendar');
        // prepare day slots
        const days = [];
        for (let i = 0; i < DAYS; i++) {
          const d = new Date(start);
          d.setDate(d.getDate() + i);
          days.push({ date: d, events: [] });
        }
        // group events by day
        data.items.forEach(ev => {
          const dt = new Date(ev.start.dateTime || ev.start.date);
          days.forEach(slot => {
            if (slot.date.toDateString() === dt.toDateString()) {
              slot.events.push(ev);
            }
          });
        });

        // render each day-block
        days.forEach(slot => {
          const block = document.createElement('div');
          block.className = 'day-block';

          const title = document.createElement('h4');
          title.textContent = slot.date.toDateString();
          block.appendChild(title);

          const ul = document.createElement('ul');
          // only first MAX_PER_DAY events
          const todays = slot.events.slice(0, MAX_PER_DAY);
          if (todays.length === 0) {
            const li = document.createElement('li');
            li.textContent = 'No events.';
            ul.appendChild(li);
          } else {
            todays.forEach(ev => {
              const li = document.createElement('li');
              const time = new Date(ev.start.dateTime || ev.start.date)
                              .toLocaleTimeString();
              li.innerHTML = `<span class="time">${time}</span>${ev.summary}`;
              if (ev.location) {
                const rawLoc = ev.location.trim();
                const href = rawLoc.match(/^https?:\/\//i)
                  ? rawLoc
                  : 'https://maps.google.com/?q=' + encodeURIComponent(rawLoc);
                const locEl = document.createElement('div');
                locEl.className = 'location';
                locEl.innerHTML = `<a href="${href}" target="_blank">${rawLoc}</a>`;
                li.appendChild(locEl);
              }
              ul.appendChild(li);
            });
          }

          block.appendChild(ul);
          container.appendChild(block);
        });
      })
      .catch(err => {
        document.getElementById('err').textContent = `Error: ${err.message}`;
        console.error(err);
      });
  </script>

</body>
</html>
